*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}

:root{
  --bg:#0d1117;
  --surface:#161b22;
  --surface2:#21262d;
  --border:#30363d;
  --accent:#00d4aa;
  --accent2:#ff6b35;
  --accent3:#7c3aed;
  --text:#e6edf3;
  --muted:#8b949e;
  --danger:#f85149;
}

body{
  background:var(--bg);
  color:var(--text);
  font-family:'Fira Code',monospace;
  height:100vh;
  display:flex;
  flex-direction:column;
  overflow:hidden;
}

/* === TOP BAR === */
.topbar{
  display:flex;
  align-items:center;
  gap:1rem;
  padding:.6rem 1.2rem;
  background:var(--surface);
  border-bottom:1px solid var(--border);
  flex-shrink:0;
  z-index:10;
}
.logo{
  font-family:'Syne',sans-serif;
  font-weight:800;
  font-size:1.1rem;
  letter-spacing:-.02em;
  color:var(--accent);
  white-space:nowrap;
}
.logo span{color:var(--accent2)}

.topbar-actions{
  display:flex;
  align-items:center;
  gap:.5rem;
  margin-left:auto;
}

.btn{
  display:flex;align-items:center;gap:.4rem;
  padding:.35rem .75rem;
  background:var(--surface2);
  border:1px solid var(--border);
  color:var(--text);
  font-family:'Fira Code',monospace;
  font-size:.72rem;
  cursor:pointer;
  border-radius:4px;
  transition:all .15s;
  white-space:nowrap;
}
.btn:hover{border-color:var(--accent);color:var(--accent);background:rgba(0,212,170,.05)}
.btn.primary{background:var(--accent);border-color:var(--accent);color:#000;font-weight:500}
.btn.primary:hover{background:#00b894}
.btn svg{width:13px;height:13px;flex-shrink:0}

/* === MAIN LAYOUT === */
.main{
  display:flex;
  flex:1;
  overflow:hidden;
}

/* === SIDEBAR === */
.sidebar{
  width:280px;
  flex-shrink:0;
  background:var(--surface);
  border-right:1px solid var(--border);
  display:flex;
  flex-direction:column;
  overflow:hidden;
}

.sidebar-section{
  padding:.75rem 1rem;
  border-bottom:1px solid var(--border);
}
.sidebar-section-title{
  font-family:'Syne',sans-serif;
  font-size:.65rem;
  font-weight:600;
  letter-spacing:.12em;
  text-transform:uppercase;
  color:var(--muted);
  margin-bottom:.6rem;
}

/* Drop zone */
.dropzone{
  border:1.5px dashed var(--border);
  border-radius:6px;
  padding:1rem;
  text-align:center;
  cursor:pointer;
  transition:all .2s;
  position:relative;
}
.dropzone:hover,.dropzone.drag-over{
  border-color:var(--accent);
  background:rgba(0,212,170,.04);
}
.dropzone input{position:absolute;inset:0;opacity:0;cursor:pointer}
.dropzone-icon{font-size:1.6rem;display:block;margin-bottom:.4rem}
.dropzone-text{font-size:.65rem;color:var(--muted);line-height:1.5}
.dropzone-text strong{color:var(--accent);display:block;font-size:.75rem}

/* Layer list */
.layers-list{
  flex:1;
  overflow-y:auto;
  padding:.5rem;
}
.layers-list::-webkit-scrollbar{width:4px}
.layers-list::-webkit-scrollbar-track{background:transparent}
.layers-list::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px}

.layer-item{
  display:flex;
  align-items:center;
  gap:.5rem;
  padding:.5rem .6rem;
  border-radius:5px;
  cursor:pointer;
  transition:background .15s;
  margin-bottom:.25rem;
  border:1px solid transparent;
}
.layer-item:hover{background:var(--surface2)}
.layer-item.active{background:var(--surface2);border-color:var(--border)}

.layer-color{
  width:12px;height:12px;
  border-radius:2px;
  flex-shrink:0;
}
.layer-name{
  flex:1;
  font-size:.72rem;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
.layer-count{
  font-size:.6rem;
  color:var(--muted);
  background:var(--bg);
  padding:.1rem .35rem;
  border-radius:3px;
}
.layer-toggle{
  width:16px;height:16px;
  display:flex;align-items:center;justify-content:center;
  opacity:.5;
  transition:opacity .15s;
}
.layer-toggle:hover{opacity:1}
.layer-remove{
  width:14px;height:14px;
  opacity:0;
  color:var(--danger);
  transition:opacity .15s;
  cursor:pointer;
}
.layer-item:hover .layer-remove{opacity:.7}
.layer-remove:hover{opacity:1!important}

/* Visibility toggle checkbox style */
.vis-check{display:none}
.vis-label{
  width:28px;height:16px;
  background:var(--border);
  border-radius:8px;
  position:relative;
  cursor:pointer;
  flex-shrink:0;
  transition:background .2s;
}
.vis-label::after{
  content:'';
  position:absolute;
  left:2px;top:2px;
  width:12px;height:12px;
  background:var(--muted);
  border-radius:50%;
  transition:all .2s;
}
.vis-check:checked + .vis-label{background:var(--accent)}
.vis-check:checked + .vis-label::after{left:14px;background:#000}

/* Info panel */
.info-panel{
  padding:.75rem 1rem;
  border-bottom:1px solid var(--border);
  font-size:.65rem;
  line-height:1.8;
  color:var(--muted);
}
.info-panel .stat{
  display:flex;justify-content:space-between;
}
.info-panel .stat-val{color:var(--text)}

/* === MAP === */
.map-wrapper{
  flex:1;
  position:relative;
  overflow:hidden;
  background:var(--bg);
}

/* Subtle dot grid */
.map-wrapper::before{
  content:'';
  position:absolute;
  inset:0;
  background-image:radial-gradient(circle, rgba(255,255,255,.04) 1px, transparent 1px);
  background-size:28px 28px;
  pointer-events:none;
}

#map-svg{
  width:100%;
  height:100%;
  cursor:grab;
  display:block;
}
#map-svg:active{cursor:grabbing}

/* Empty state */
.empty-state{
  position:absolute;
  inset:0;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:1rem;
  color:var(--muted);
  pointer-events:none;
}
.empty-state.hidden{display:none}
.empty-icon{font-size:3rem;opacity:.3}
.empty-text{font-size:.8rem;opacity:.6;text-align:center;line-height:1.8}

/* Map controls */
.map-controls{
  position:absolute;
  bottom:1.2rem;
  right:1.2rem;
  display:flex;
  flex-direction:column;
  gap:.4rem;
}
.map-btn{
  width:32px;height:32px;
  background:var(--surface);
  border:1px solid var(--border);
  color:var(--text);
  font-size:1rem;
  cursor:pointer;
  border-radius:4px;
  display:flex;align-items:center;justify-content:center;
  transition:all .15s;
  font-family:'Fira Code',monospace;
}
.map-btn:hover{border-color:var(--accent);color:var(--accent)}

/* Tooltip */
#tooltip{
  position:absolute;
  background:rgba(13,17,23,.95);
  border:1px solid var(--border);
  border-radius:6px;
  padding:.6rem .9rem;
  font-size:.65rem;
  pointer-events:none;
  max-width:240px;
  z-index:1000;
  display:none;
  backdrop-filter:blur(8px);
  box-shadow:0 4px 24px rgba(0,0,0,.5);
}
#tooltip.visible{display:block}
#tooltip .tt-title{
  font-family:'Syne',sans-serif;
  font-weight:600;
  font-size:.8rem;
  color:var(--accent);
  margin-bottom:.4rem;
  padding-bottom:.3rem;
  border-bottom:1px solid var(--border);
}
#tooltip .tt-row{
  display:flex;
  justify-content:space-between;
  gap:.8rem;
  margin-top:.2rem;
  color:var(--muted);
}
#tooltip .tt-val{color:var(--text);text-align:right;max-width:140px;word-break:break-all}

/* Coords display */
.coords-bar{
  position:absolute;
  bottom:1.2rem;
  left:1rem;
  font-size:.6rem;
  color:var(--muted);
  background:rgba(13,17,23,.8);
  padding:.25rem .6rem;
  border-radius:3px;
  border:1px solid var(--border);
  pointer-events:none;
}

/* Progress bar */
.progress-bar{
  position:absolute;
  top:0;left:0;right:0;
  height:2px;
  background:var(--accent);
  transform-origin:left;
  transform:scaleX(0);
  transition:transform .3s;
  z-index:100;
}
.progress-bar.active{animation:progress-anim 1.2s ease-in-out infinite}
@keyframes progress-anim{
  0%{transform:scaleX(0);transform-origin:left}
  50%{transform:scaleX(.7);transform-origin:left}
  51%{transform-origin:right}
  100%{transform:scaleX(0);transform-origin:right}
}

/* Toast */
.toast{
  position:fixed;
  bottom:1.5rem;
  left:50%;
  transform:translateX(-50%) translateY(100px);
  background:var(--surface2);
  border:1px solid var(--border);
  color:var(--text);
  padding:.5rem 1rem;
  border-radius:6px;
  font-size:.72rem;
  z-index:9999;
  transition:transform .3s;
  pointer-events:none;
}
.toast.show{transform:translateX(-50%) translateY(0)}
.toast.success{border-color:var(--accent);color:var(--accent)}
.toast.error{border-color:var(--danger);color:var(--danger)}

/* Layer all-toggle */
.all-toggle-row{
  display:flex;align-items:center;gap:.5rem;
  padding:.4rem .6rem;
  font-size:.65rem;color:var(--muted);
  border-bottom:1px solid var(--border);
  margin-bottom:.25rem;
}

/* Scrollbar style */
::-webkit-scrollbar{width:5px;height:5px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px}

@keyframes fadeInUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}
.layer-item{animation:fadeInUp .2s ease}